/*!
 * bootstrap-tags 1.1.0
 * https://github.com/maxwells/bootstrap-tags
 * Copyright 2013 Max Lahey; Licensed MIT
 */

!function(a){!function(){window.Tags||(window.Tags={}),jQuery(function(){return a.tags=function(b,c){var d,e,f,g,h,i,j,k,l=this;null==c&&(c={});for(e in c)h=c[e],this[e]=h;if(this.bootstrapVersion||(this.bootstrapVersion="3"),this.readOnly||(this.readOnly=!1),this.suggestOnClick||(this.suggestOnClick=!1),this.suggestions||(this.suggestions=[]),this.suggestionsId||(this.suggestionsId=[]),this.restrictTo=null!=c.restrictTo?c.restrictTo.concat(this.suggestions):!1,this.exclude||(this.exclude=!1),this.displayPopovers=null!=c.popovers?!0:null!=c.popoverData,this.popoverTrigger||(this.popoverTrigger="hover"),this.tagClass||(this.tagClass="btn-info"),this.tagSize||(this.tagSize="md"),this.promptText||(this.promptText="Enter tags..."),this.caseInsensitive||(this.caseInsensitive=!1),this.readOnlyEmptyMessage||(this.readOnlyEmptyMessage="No tags to display..."),this.beforeAddingTag||(this.beforeAddingTag=function(){}),this.afterAddingTag||(this.afterAddingTag=function(){}),this.beforeDeletingTag||(this.beforeDeletingTag=function(){}),this.afterDeletingTag||(this.afterDeletingTag=function(){}),this.definePopover||(this.definePopover=function(a){return'associated content for "'+a+'"'}),this.excludes||(this.excludes=function(){return!1}),this.tagRemoved||(this.tagRemoved=function(){}),this.pressedReturn||(this.pressedReturn=function(){}),this.pressedDelete||(this.pressedDelete=function(){}),this.pressedDown||(this.pressedDown=function(){}),this.pressedUp||(this.pressedUp=function(){}),this.$element=a(b),null!=c.tagData?this.tagsArray=c.tagData:(g=a(".tag-data",this.$element).html(),this.tagsArray=null!=g?g.split(","):[]),null!=c.idData?this.idsArray=c.idData:(d=a(".id-data",this.$element).html(),this.idsArray=null!=d?d.split(","):[]),c.popoverData)this.popoverArray=c.popoverData;else for(this.popoverArray=[],k=this.tagsArray,i=0,j=k.length;j>i;i++)f=k[i],this.popoverArray.push(null);return this.getTags=function(){return l.tagsArray},this.getTagsId=function(){return l.idsArray},this.getTagsContent=function(){return l.popoverArray},this.getTagsWithContent=function(){var a,b,c,d;for(a=[],b=c=0,d=l.tagsArray.length-1;d>=0?d>=c:c>=d;b=d>=0?++c:--c)a.push({tag:l.tagsArray[b],content:l.popoverArray[b]});return a},this.getTag=function(a){var b;return b=l.tagsArray.indexOf(a),b>-1?l.tagsArray[b]:null},this.getTagId=function(a){var b;return b=l.tagsArray.indexOf(a),b>1?l.idsArray[b]:null},this.getTagWithContent=function(a){var b;return b=l.tagsArray.indexOf(a),{tag:l.tagsArray[b],content:l.popoverArray[b]}},this.hasTag=function(a){return l.tagsArray.indexOf(a)>-1},this.removeTagClicked=function(b){return"A"===b.currentTarget.tagName&&(l.removeTag(a("span",b.currentTarget.parentElement).html()),a(b.currentTarget.parentNode).remove()),l},this.removeLastTag=function(){return l.removeTag(l.tagsArray[l.tagsArray.length-1]),l},this.removeTag=function(a){if(l.tagsArray.indexOf(a)>-1){if(l.beforeDeletingTag(a)===!1)return;l.popoverArray.splice(l.tagsArray.indexOf(a),1),l.idsArray.splice(l.tagsArray.indexOf(a),1),l.tagsArray.splice(l.tagsArray.indexOf(a),1),l.renderTags(),l.afterDeletingTag(a)}return l},this.addTag=function(a,b){var c;if((l.restrictTo===!1||-1!==l.restrictTo.indexOf(a))&&l.tagsArray.indexOf(a)<0&&a.length>0&&(l.exclude===!1||-1===l.exclude.indexOf(a))&&!l.excludes(a)){if(l.beforeAddingTag(a)===!1)return;c=l.definePopover(a),l.popoverArray.push(c||null),l.tagsArray.push(a),l.idsArray.push(b),l.afterAddingTag(a),l.renderTags()}return l},this.addTagWithContent=function(a,b){if((l.restrictTo===!1||-1!==l.restrictTo.indexOf(a))&&l.tagsArray.indexOf(a)<0&&a.length>0){if(l.beforeAddingTag(a)===!1)return;l.tagsArray.push(a),l.popoverArray.push(b),l.afterAddingTag(a),l.renderTags()}return l},this.renameTag=function(a,b){return l.tagsArray[l.tagsArray.indexOf(a)]=b,l.renderTags(),l},this.setPopover=function(a,b){return l.popoverArray[l.tagsArray.indexOf(a)]=b,l.renderTags(),l},this.clickHandler=function(a){return l.makeSuggestions(a,!0)},this.keyDownHandler=function(a){var b,c,d;switch(b=null!=a.keyCode?a.keyCode:a.which){case 13:return l.pressedReturn(a),f=a.target.value,-1!==l.suggestedIndex&&(f=l.suggestionList[l.suggestedIndex],d=l.suggestionIdList[l.suggestedIndex]),l.addTag(f,d),a.target.value="",l.renderTags(),l.hideSuggestions();case 46:case 8:if(l.pressedDelete(a),""===a.target.value&&l.removeLastTag(),1===a.target.value.length)return l.hideSuggestions();break;case 40:if(l.pressedDown(a),""!==l.input.val()||-1!==l.suggestedIndex&&null!=l.suggestedIndex||l.makeSuggestions(a,!0),c=l.suggestionList.length,l.suggestedIndex=l.suggestedIndex<c-1?l.suggestedIndex+1:c-1,l.selectSuggested(l.suggestedIndex),l.suggestedIndex>=0)return l.scrollSuggested(l.suggestedIndex);break;case 38:if(l.pressedUp(a),l.suggestedIndex=l.suggestedIndex>0?l.suggestedIndex-1:0,l.selectSuggested(l.suggestedIndex),l.suggestedIndex>=0)return l.scrollSuggested(l.suggestedIndex);break;case 9:case 27:return l.hideSuggestions(),l.suggestedIndex=-1}},this.keyUpHandler=function(a){var b;return b=null!=a.keyCode?a.keyCode:a.which,40!==b&&38!==b&&27!==b?l.makeSuggestions(a,!1):void 0},this.getSuggestions=function(b,c){var d=this;return this.caseInsensitive&&(b=b.toLowerCase()),this.suggestionList=[],this.suggestionIdList=[],a.each(this.suggestions,function(a,e){var f;return f=d.caseInsensitive?e.substring(0,b.length):e.substring(0,b.length).toLowerCase(),d.tagsArray.indexOf(e)<0&&f===b&&(b.length>0||c)?(d.suggestionList.push(e),d.suggestionIdList.push(d.suggestionsId[a])):void 0}),this.suggestionList},this.makeSuggestions=function(b,c){var d;return d=null!=b.target.value?b.target.value:b.target.textContent,l.suggestedIndex=-1,l.$suggestionList.html(""),a.each(l.getSuggestions(d,c),function(a,b){return l.$suggestionList.append(l.template("tags_suggestion",{suggestion:b}))}),l.$(".tags-suggestion").mouseover(l.selectSuggestedMouseOver),l.$(".tags-suggestion").click(l.suggestedClicked),l.suggestionList.length>0?l.showSuggestions():l.hideSuggestions()},this.suggestedClicked=function(a){var b;return f=a.target.textContent,-1!==l.suggestedIndex&&(f=l.suggestionList[l.suggestedIndex],b=l.suggestionIdList[l.suggestedIndex]),l.addTag(f,b),l.input.val(""),l.makeSuggestions(a,!1),l.input.focus(),l.hideSuggestions()},this.hideSuggestions=function(){return l.$(".tags-suggestion-list").css({display:"none"})},this.showSuggestions=function(){return l.$(".tags-suggestion-list").css({display:"block"})},this.selectSuggestedMouseOver=function(b){return a(".tags-suggestion").removeClass("tags-suggestion-highlighted"),a(b.target).addClass("tags-suggestion-highlighted"),a(b.target).mouseout(l.selectSuggestedMousedOut),l.suggestedIndex=l.$(".tags-suggestion").index(a(b.target))},this.selectSuggestedMousedOut=function(b){return a(b.target).removeClass("tags-suggestion-highlighted")},this.selectSuggested=function(b){var c;return a(".tags-suggestion").removeClass("tags-suggestion-highlighted"),c=l.$(".tags-suggestion").eq(b),c.addClass("tags-suggestion-highlighted")},this.scrollSuggested=function(a){var b,c,d,e;return c=l.$(".tags-suggestion").eq(a),d=l.$(".tags-suggestion").eq(0),b=c.position(),e=d.position(),null!=b?l.$(".tags-suggestion-list").scrollTop(b.top-e.top):void 0},this.adjustInputPosition=function(){var b,c,d,e,f,g;return f=l.$(".tag").last(),g=f.position(),c=null!=g?g.left+f.outerWidth(!0):0,d=null!=g?g.top:0,e=l.$element.width()-c,a(".tags-input",l.$element).css({paddingLeft:Math.max(c,0),paddingTop:Math.max(d,0),width:e}),b=null!=g?g.top+f.outerHeight(!0):22,l.$element.css({paddingBottom:b-l.$element.height()})},this.renderTags=function(){var b;return b=l.$(".tags"),b.html(""),l.input.attr("placeholder",l.promptText),a.each(l.tagsArray,function(c,d){return d=a(l.formatTag(c,d,l.idsArray[c])),a("a",d).click(l.removeTagClicked),a("a",d).mouseover(l.toggleCloseColor),a("a",d).mouseout(l.toggleCloseColor),l.displayPopovers&&l.initializePopoverFor(d,l.tagsArray[c],l.popoverArray[c]),b.append(d)}),l.adjustInputPosition()},this.renderReadOnly=function(){var b;return b=l.$(".tags"),b.html(0===l.tagsArray.length?l.readOnlyEmptyMessage:""),a.each(l.tagsArray,function(c,d){return d=a(l.formatTag(c,d,l.idsArray[c],!0)),l.displayPopovers&&l.initializePopoverFor(d,l.tagsArray[c],l.popoverArray[c]),b.append(d)})},this.initializePopoverFor=function(b,d,e){return c={title:d,content:e,placement:"bottom"},"hoverShowClickHide"===l.popoverTrigger?(a(b).mouseover(function(){return a(b).popover("show"),a(".tag").not(b).popover("hide")}),a(document).click(function(){return a(b).popover("hide")})):c.trigger=l.popoverTrigger,a(b).popover(c)},this.toggleCloseColor=function(b){var c,d;return d=a(b.currentTarget),c=d.css("opacity"),c=.8>c?1:.6,d.css({opacity:c})},this.formatTag=function(a,b,c,d){var e;return null==d&&(d=!1),e=b.replace("<","&lt;").replace(">","&gt;"),l.template("tag",{tag:e,tagId:c,tagClass:l.tagClass,isPopover:l.displayPopovers,isReadOnly:d,tagSize:l.tagSize})},this.addDocumentListeners=function(){return a(document).mouseup(function(a){var b;return b=l.$(".tags-suggestion-list"),0===b.has(a.target).length?l.hideSuggestions():void 0})},this.template=function(a,b){return Tags.Templates.Template(this.getBootstrapVersion(),a,b)},this.$=function(b){return a(b,this.$element)},this.getBootstrapVersion=function(){return Tags.bootstrapVersion||this.bootstrapVersion},this.initializeDom=function(){return this.$element.append(this.template("tags_container"))},this.init=function(){return this.$element.addClass("bootstrap-tags").addClass("bootstrap-"+this.getBootstrapVersion()),this.initializeDom(),this.readOnly?(this.renderReadOnly(),this.removeTag=function(){},this.removeTagClicked=function(){},this.removeLastTag=function(){},this.addTag=function(){},this.addTagWithContent=function(){},this.renameTag=function(){},this.setPopover=function(){}):(this.input=a(this.template("input",{tagSize:this.tagSize})),this.suggestOnClick&&this.input.click(this.clickHandler),this.input.keydown(this.keyDownHandler),this.input.keyup(this.keyUpHandler),this.$element.append(this.input),this.$suggestionList=a(this.template("suggestion_list")),this.$element.append(this.$suggestionList),this.renderTags(),this.addDocumentListeners())},this.init(),this},a.fn.tags=function(b){var c,d;return d={},c="number"==typeof b?b:-1,this.each(function(e,f){var g;return g=a(f),null==g.data("tags")&&g.data("tags",new a.tags(this,b)),c===e||0===e?d=g.data("tags"):void 0}),d}})}.call(this),function(){window.Tags||(window.Tags={}),Tags.Helpers||(Tags.Helpers={}),Tags.Helpers.addPadding=function(a,b,c){return null==b&&(b=1),null==c&&(c=!0),c?0===b?a:Tags.Helpers.addPadding("&nbsp"+a+"&nbsp",b-1):a}}.call(this),function(){var a;window.Tags||(window.Tags={}),Tags.Templates||(Tags.Templates={}),(a=Tags.Templates)["2"]||(a["2"]={}),Tags.Templates["2"].input=function(a){var b;return null==a&&(a={}),b=function(){switch(a.tagSize){case"sm":return"small";case"md":return"medium";case"lg":return"large"}}(),"<input type='text' class='tags-input input-"+b+"' />"}}.call(this),function(){var a;window.Tags||(window.Tags={}),Tags.Templates||(Tags.Templates={}),(a=Tags.Templates)["2"]||(a["2"]={}),Tags.Templates["2"].tag=function(a){return null==a&&(a={}),"<div class='tag label "+a.tagClass+" "+a.tagSize+"' "+(a.isPopover?"rel='popover'":"")+">    <span>"+Tags.Helpers.addPadding(a.tag,2,a.isReadOnly)+"</span>    "+(a.isReadOnly?"":"<a><i class='remove icon-remove-sign icon-white' /></a>")+"  </div>"}}.call(this),function(){var a;window.Tags||(window.Tags={}),Tags.Templates||(Tags.Templates={}),(a=Tags.Templates)["3"]||(a["3"]={}),Tags.Templates["3"].input=function(a){return null==a&&(a={}),"<input type='text' class='form-control tags-input input-"+a.tagSize+"' />"}}.call(this),function(){var a;window.Tags||(window.Tags={}),Tags.Templates||(Tags.Templates={}),(a=Tags.Templates)["3"]||(a["3"]={}),Tags.Templates["3"].tag=function(a){return null==a&&(a={}),"<div class='tag label "+a.tagClass+" "+a.tagSize+"' "+(a.isPopover?"rel='popover'":"")+" id='"+a.tagId+"'>    <span>"+Tags.Helpers.addPadding(a.tag,2,a.isReadOnly)+"</span>    "+(a.isReadOnly?"":"<a><i class='remove glyphicon glyphicon-remove-sign glyphicon-white' /></a>")+"  </div>"}}.call(this),function(){var a;window.Tags||(window.Tags={}),Tags.Templates||(Tags.Templates={}),(a=Tags.Templates).shared||(a.shared={}),Tags.Templates.shared.suggestion_list=function(a){return null==a&&(a={}),'<ul class="tags-suggestion-list dropdown-menu"></ul>'}}.call(this),function(){var a;window.Tags||(window.Tags={}),Tags.Templates||(Tags.Templates={}),(a=Tags.Templates).shared||(a.shared={}),Tags.Templates.shared.tags_container=function(a){return null==a&&(a={}),'<div class="tags"></div>'}}.call(this),function(){var a;window.Tags||(window.Tags={}),Tags.Templates||(Tags.Templates={}),(a=Tags.Templates).shared||(a.shared={}),Tags.Templates.shared.tags_suggestion=function(a){return null==a&&(a={}),"<li class='tags-suggestion'>"+a.suggestion+"</li>"}}.call(this),function(){window.Tags||(window.Tags={}),Tags.Templates||(Tags.Templates={}),Tags.Templates.Template=function(a,b,c){return null!=Tags.Templates[a]&&null!=Tags.Templates[a][b]?Tags.Templates[a][b](c):Tags.Templates.shared[b](c)}}.call(this)}(window.jQuery);